import{createApp,reactive}from"./petite-vue@0.4.1.js";import{getParamsByUrl,getRandomNum,isVisible}from"./utils.js";import works from"../data/works.js";((e,t,r,i,s,o,n,l,u)=>{const a=t.querySelector("#title"),m=e.location.href,h="https://www.ghibli.jp/gallery/",c="ghibli-album-id",g={fetch:()=>JSON.parse(r.getItem(c)),save(e){r.setItem(c,JSON.stringify(e))},remove(){r.removeItem(c)}},d=s({isShow:!1,isCloseButtonShow:!1,currentImageUrl:`${h}${u[0].albumFolder}001.jpg`,get max(){return u.find((e=>this.currentImageUrl.includes(e.albumFolder))).numOfImages},get currentImageIdx(){return Number(this.currentImageUrl.slice(-7).split(".")[0])},get progress(){return`${String(this.currentImageIdx).padStart(String(this.max).length,"0")} / ${this.max}`},showSlider(e){this.isShow=!0,this.currentImageUrl=e},handleMouseMove(){this.isCloseButtonShow||(this.isCloseButtonShow=!0,setTimeout((()=>this.isCloseButtonShow=!1),2e3))},prev(){const e=`${String(1===this.currentImageIdx?this.max:this.currentImageIdx-1).padStart(3,"0")}.jpg`;this.currentImageUrl=this.currentImageUrl.replace(this.currentImageUrl.slice(-7),e)},next(){const e=`${String(this.currentImageIdx===this.max?1:this.currentImageIdx+1).padStart(3,"0")}.jpg`;this.currentImageUrl=this.currentImageUrl.replace(this.currentImageUrl.slice(-7),e)},close(){this.isShow=this.isCloseButtonShow=!1}}),I={works:u,Slider:d,language:o().en?"en":"jp",isLoading:!0,isTopButtonHide:!0,currentAlbumIdx:0,get currentAlbum(){return this.works[this.currentAlbumIdx]},get bodyStyle(){return this.isLoading||d.isShow?"overflow: hidden;":""},get bodyWidth(){return t.body.clientWidth},init(){const e=g.fetch();if(e)return this.currentAlbumIdx=e;this.currentAlbumIdx=n(0,this.works.length),g.save(this.currentAlbumIdx)},endLoading(e){setTimeout((()=>this.isLoading=!1),1e3*e)},handleScroll(){if(l(a))return this.isTopButtonHide=!0;this.isTopButtonHide=!1},moveToTop(){e.scrollTo(0,0)},getImageUrl(e){return`${h}${this.currentAlbum.albumFolder}${String(e+1).padStart(3,"0")}.jpg`},changeAlbum(t){this.currentAlbumIdx=t,g.save(this.currentAlbumIdx),setTimeout((()=>{e.history.replaceState({},"",m)}))}};i(I).mount(),e.onload=()=>{I.moveToTop(),I.endLoading(1)},e.onscroll=()=>I.handleScroll(),e.onresize=()=>d.close(),e.onfocus=()=>g.save(I.currentAlbumIdx),e.onblur=()=>g.remove()})(window,document,localStorage,createApp,reactive,getParamsByUrl,getRandomNum,isVisible,works);